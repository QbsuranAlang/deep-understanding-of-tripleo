# 节点伸缩

---

## 支持收缩或者扩展的节点类型

| 节点类型 | 扩展? | 收缩? | 备注 |
| :--- | :--- | --- | --- |
| Controller | N | N | 一旦部署完成，控制节点不支持收缩或者扩展。 |
| Compute | Y | Y | |
| Ceph Storage Nodes | Y | N | 在部署时至少有一个ceph节点时，才支持扩展。 |
| Block Storage Nodes | N | N | 一旦部署完成，Cinder节点不支持收缩或者扩展。 |
| Object Storage Nodes | Y | Y | |


## 删除计算节点

1. 删除计算节点前，先把VM从当前计算节点前迁移出去
2. 在overcloud中，禁用nova service。
3. 在 undercloud中，查询stack 名称
```
$ heat stack-list
```
4. 在undercloud中，查询要删除的nova compute 节点的UUID
```
openstack overcloud node delete --stack [STACK_UUID] --templates \
-e [ENVIRONMENT_FILE] [NODE1_UUID] [NODE2_UUID] [NODE3_UUID]
```
> 在删除节点时需要使用和部署时一样的environment参数(e.g. -e 或者 --environment-file)。不需要其他的参数。

5. 在删除nova-service
```
$ source ~/stack/overcloudrc
$ nova service-delete [service-id]
$ source ~/stack/stackrc
```
6. 删除nuetro agent
```
$ source ~/stack/overcloudrc
$ neutron agent-list
$ neutron agent-delete [openvswitch-service-id]
$ source ~/stack/stackrc
```
